<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org/DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.paic.pawj.answer.dao.InvestigationCommentMapper">
	<insert id="addInvestigationComment" parameterType="com.paic.pawj.answer.dao.InvestigationComment">
		INSERT INTO pawj_ivtg_comments(investigation_id, comment_id, answerer, created_time) 
		    VALUES(#{investigationID}, #{commentID}, #{answerer}, #{createTime})
	</insert>
	
	<insert id="addInvestigationScore" parameterType="com.paic.pawj.answer.dao.InvestigationScore">
		INSERT INTO pawj_ivtg_score(investigation_id, score, answerer) 
		VALUES(#{investigationID}, #{score}, #{answerer})
	</insert>
	
	<select id="queryHottestComments" resultType="com.paic.pawj.answer.dao.InvestigationComment">
		select t1.comment_id commentID,t1.comment 
		from pawj_basic_comments t1,
	         (SELECT count(comment_id) num,comment_id FROM pawj_ivtg_comments p
	          group by comment_id)t2
	    where t1.comment_id =  t2.comment_id
	    order by t2.num desc
	    limit 0,5
	</select>
	
	<!-- 检查记录是否存在 -->
	<select id = "haveItvgCommentExist" parameterType="com.paic.pawj.answer.dao.InvestigationComment"
	resultType = "int">
		SELECT count(*) from pawj_ivtg_comments
		where investigation_id = #{investigationID}
		and comment_id = #{commentID}
		and answerer = #{answerer}
	</select>
	
</mapper>