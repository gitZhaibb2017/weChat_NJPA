<%@page pageEncoding="UTF-8" contentType="text/html; charset=UTF-8" %> 
<!DOCTYPE html>
<html ng-app="questionWin">
<head>
<meta charset="utf-8">
<title>Insert title here</title>
<script type="text/javascript" src="/pawj/libs/easyui/jquery.min.js"></script>
<script type="text/javascript" src="/pawj/libs/angular.min.js"></script>
<script type="text/javascript"
	src="/pawj/libs/easyui/jquery.easyui.min.js"></script>
<script type="text/javascript"
	src="/pawj/libs/easyui/locale/easyui-lang-zh_CN.js"></script>
<script type="text/javascript" src="/pawj/wjadd/js/myQuestionWindow.js"></script>
<link rel="stylesheet" type="text/css"
	href="/pawj/libs/easyui/themes/default/easyui.css" />
<link rel="stylesheet" type="text/css"
	href="/pawj/libs/easyui/themes/icon.css" />
<link rel="stylesheet" type="text/css"
	href="/pawj/wjadd/css/input.css" />
</head>
<body ng-controller="questionCtrl" >
<form name="questionForm">
	<div ng-if="<%=request.getParameter("view")%>" >
		<span class="icon-tip">&nbsp;</span><span style="font-size:10px">当前问卷处于已发布状态，只能查看题目信息。</span>
	</div>
	<div class="panel" style="display: block;margin-top:10px" ng-repeat="obj in questions" repeat-finish>
	<div class="panel-header" ><div class="panel-title">题目{{$index+1}}</div><div ng-if="!<%=request.getParameter("view")%>" class="panel-tool" ng-if="questions.length>1"><a href="javascript:void(0)" class="icon-remove panel-tool-a" ng-click="delQuestion(obj,$index+1)"></a></div></div>
	<input type="hidden" name="qsrId" id="qsrId" value=<%=request.getParameter("qsrId")%>>

	<div  title="题目{{$index+1}}" class="panel-body" id="qst{{$index}}" 
		 >
		<table cellpadding="5">
			<tr>
				<td style="width:145px" align="right">题目序号：</td>
				<td>
				<select ng-options="seqStr for seqStr in allSeqArr" ng-model="obj.seq" 
					required ng-disabled="<%=request.getParameter("view")%>"><option value="">请选择</option></select>
				</td>
			</tr>
			<tr>
				<td align="right">题目标题：</td>
				<td><input  
					type="text" ng-model="obj.subject" required style="width:550px" <%if("true".equals(request.getParameter("view"))){%>readOnly<%}%>></input></td>
			</tr>
			<tr>
				<td align="right">题目类型：</td>
				<td><select ng-options="type.dicValue as type.dicDesc for type in qstTypes" ng-model="obj.questionType" ng-change="setQuestionContext(obj)"
					required ng-disabled="<%=request.getParameter("view")%>"><option value="">请选择</option></select><a href="javascript:void(0)" ng-click="addOption(obj.options)" ng-if="obj.options.length==0&&obj.questionType=='scr'&&!<%=request.getParameter("view")%>">新增题枝</a></td>
			</tr>
			<tr ng-if="obj.questionType=='mc'||obj.questionType=='mcs'||obj.questionType=='scr'" >
			<td colspan="2">
				<table>
				<tr ng-repeat="subObj in obj.options" >
				<td style="width:80px"></td>
				<td>{{$index+1}}.&nbsp;</td>
				<td><span>选项编码：<input type="text" ng-model="subObj.optionCode" style="width:50px" required <%if("true".equals(request.getParameter("view"))){%>readOnly<%}%>></input>&nbsp;&nbsp;选项描述:<input 
					type="text" ng-model="subObj.optionName" required style="width:350px" <%if("true".equals(request.getParameter("view"))){%>readOnly<%}%>></input></span>
					<span ng-if="!<%=request.getParameter("view")%>"><a href="javascript:void(0)" style="" ng-click="delOption(subObj,obj)" ng-if="obj.options.length>2||obj.questionType=='scr'">删除</a></span>
					<a href="javascript:void(0)" ng-click="addOption(obj.options)" ng-if="$index==obj.options.length-1&&!<%=request.getParameter("view")%>">新增</a>
					</td>
				</tr>
				</table>
			</td>
			</tr>
		</table>
	</div>
	</div>
	<div ng-if="!<%=request.getParameter("view")%>">
	<button type="sumbit" id="saveButton" ng-click="saveQuestion(questionForm.$valid)" class="easyui-linkbutton" icon="icon-save" style="float:right">保存题目</button>
	<a href="javascript:void(0)" class="easyui-linkbutton" ng-click="addQuestion()" icon="icon-add" style="float:right">添加题目</a>
	</div>
</form>
</body>
</html>