/**
 * 页面初始化-加载数据
 */
$(function() {
	/**
	 * 绑定邮箱 发送邮箱验证码
	 */
	$("#getEmailCode").click(function() {
		// 校验邮箱
		if (!Validator.validateEMail($("#bindEmailAddress").val())) {
			$.popAlert("请输入正确的邮箱号码！");
			return false;
		}
		var that = $(this);
		var opts = {
			time : 60,
			onSet : function() {
				that.attr("disabled", "disabled");
				that.html(this.time + "后重新获取");
			},
			onClear : function() {
				that.html("重新获取");
				that.removeAttr("disabled");
				// that.css({color:'#fe6446'});
			},
			onBefore : function() {
				that.attr("disabled", "disabled");
				that.html(this.time + "后重新获取");
			}
		}
		new WJInterval(opts);
	});
	/**
	 * 绑定邮箱提交
	 */
	$("#bindEmailSubBtn").click(function() {
		// 校验邮箱
		if (!Validator.validateEMail($("#bindEmailAddress").val())) {
			$.popAlert("请输入正确的邮箱号码！");
			return false;
		}
		// 校验验证码
		if (!Validator.validateCode($("#bindEmailCode").val())) {
			$.popAlert("请输入6位数字验证码！");
			return false;
		}
	});

	//监听表单变化
	$("#bindEmail").changeListen({
		formId : "#bindEmail",
		onOK : function() {
			$("#bindEmailSubBtn").css({
				background : "#ffb71d"
			}).removeAttr("disabled");
		},
		onCancel : function() {
			$("#bindEmailSubBtn").css({
				background : "#ccc"
			}).attr("disabled","disabled");
		}
	});
});