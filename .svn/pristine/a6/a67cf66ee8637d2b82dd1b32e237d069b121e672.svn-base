
$(function() {
	/**
	 * 获取验证码-点击按钮
	 */
	
	  var wait
	  var time
     $('#getMobileCode').click(function(){
		$(this).attr("disabled",true);
		wait = 120
		$(this).val( wait + "秒后重新获取");
		time = setInterval(function(){
			setTime()
		},1000)
	});
	  
	  function setTime(){
		  wait--;
		  if(wait == 0){
		    clearInterval(time);
		    $("#getMobileCode").val("获取验证码");
			$('#getMobileCode').removeAttr("disabled");
		  }else{
			$("#getMobileCode").val(wait + "秒后重新获取"); 
		  }
	  }
	  
	/**
	 * 获取验证码-发送至手机
	 */
   $('#getMobileCode').click(function(){
		mobile = $('#bindMobileAddress').val();
		
		$.ajax({
			type : 'POST',
			url : "/pawj/auth/getCheckCode.do",
			dataType : "JSON",
			data : {
			   "mobile" : mobile
			},
			success:function(e){
			   var data = $.parseJSON(e);
			   if (data.infoMsg == 1) {
				   $.popAlert("验证码发送失败!");
				}
			}
		})
	})
   
	/**
	 * 提交验证码
	 */
    $('#bindMobileSubBtn').click(function(){
		var checkCode = $('#bindMobileCode').val().trim();
		var mobile    = $('#bindMobileAddress').val().trim();
		
		// 校验手机号码
		if(!Validator.validateRegPhone(mobile)) {
			$.popAlert("请输入11位数字的手机号码！");
			return false;
		}
	     // 校验验证码
		if(!Validator.validateCode(checkCode)) {
		 $.popAlert("请输入6位数字验证码！");
		 return false;
	    }
	  
	    $.ajax({
			type : 'POST',
			url : "/pawj/app/person/updateMobile.do",
			dataType : "JSON",
			data : {
				"mobile"    : mobile,
				"checkCode" : checkCode
			},
			success : function(e) {
				var data = $.parseJSON(e);
				if (data.msg == 1) {
					$.popAlert("ok");
				} else {
					$.popAlert("验证码有误！");
				}
			}
		})
	})
})





   
		

