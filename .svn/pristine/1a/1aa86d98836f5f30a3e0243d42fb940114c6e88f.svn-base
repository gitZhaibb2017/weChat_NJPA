//日常任务
$(function() {
	getRecord();
	$("#signToday").click(function(){
		signTody();
	});
});
//日常任务
function getRecord() {
	getMsg();
}
// 获取日常任务信息
function getMsg() {
	$.ajax({
		type : 'POST',
		url : "/pawj/getCheckInPoint.do",
		contentType : "application/json",
		//headers:{'token':'001a19a0-7e86-49d9-ba83-aac8b50a031a'},
		success : function(data) {
			console.log(data);
			if(data && data.retCode=="0000"){
				if(data.todayFlg=="true"){
					$("#isSign").html("已签到");
					$("#signToday").unbind("click");
				}else{
					$("#isSign").html("未签到");
				}
				$("#signDesc").html("连续"+data.count+"天");
				$("#signCount").html("+"+data.point);
			}else if(typeof data == "string"){
				var reg = $.parseJSON(data);
				if(reg.retCode=="9999"){
					$("#isSign").html("未签到");
					$("#signCount").html("+0");
					$("#signDesc").html("连续0天");
				}
			}
		}
	});
}
//今日签到
function signTody(){
	$.ajax({
		type : 'POST',
		url : "/pawj/updateCheckInStatus.do",
		contentType : "application/json",
		success : function(data) {
			var result =$.parseJSON(data);
			//签到成功
			if(result.retCode=="0000"){
				getRecord();
				$.popAlert("签到成功");
			}
			//失败
			else if(result.retCode=="9999"){
				$.popAlert("请先登录");
			}
		}
	});
}