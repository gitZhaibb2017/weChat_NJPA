package com.paic.pawj.basic.version.controller;

import java.util.HashMap;
import java.util.Map;

import javax.annotation.Resource;

import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.ResponseBody;

import com.paic.pawj.basic.version.service.VersionInfoService;
import com.paic.pawj.basic.version.util.Constants;

/**
 * 版本信息管理
 * 
 * @author Admin
 *
 */
@Controller
@RequestMapping("/app/version/")
public class VersionInfoController {
	public static final Log LOG = LogFactory.getLog(VersionInfoController.class);
	@Resource
	private VersionInfoService versionInfoService;
	/**
	 * 最新版本号
	 */
	@Value("${pawj.versionNum}")
	private String versionNum;
	/**
	 * 是否必须要升级
	 */
	@Value("${pawj.must}")
	private String must;

	/**
	 * 版本信息查询
	 * 
	 * @return
	 */
	@RequestMapping("queryVersion.do")
	@ResponseBody
	public Map<String, Object> queryVersionInfo() {
		Map<String, Object> result = new HashMap<String, Object>();
		try {
			result.put("data", versionInfoService.queryVersionInfo());
			result.put(Constants.STATUS, Constants.RESULT_SUCCESS_CODE);
		} catch (Exception e) {
			LOG.info("错误原因：", e);
			result.put(Constants.STATUS, Constants.RESULT_FAIL_CODE);
		}
		return result;
	}

	/**
	 * 获取最新版本号
	 * 
	 * @return
	 */
	@RequestMapping("getLatestVersionNum.do")
	@ResponseBody
	public Map<String, Object> getLatestVersionNum() {
		Map<String, Object> result = new HashMap<String, Object>();
		result.put("versionNum", versionNum);
		result.put("must", must);
		return result;
	}
}
